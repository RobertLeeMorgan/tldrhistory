import{j as e,e as d,b as u,u as j,a as w,L as m,f as v,g as $,r as N}from"./index-B6wW9msG.js";import{e as C}from"./formatWidget-DsoUn4p-.js";function h(t){const s=t.split("-");let a,n,r;return t.startsWith("-")?(a=s[1],n=s[2],r=s[3],a=Math.abs(a)+" BCE"):(a=s[0],n=s[1],r=s[2],a=Math.abs(a)+" CE"),a=a.padStart(4,"0"),n=n.padStart(2,"0"),r=r.padStart(2,"0"),r==="00"&&n==="00"?a:(n=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][parseInt(n)-1],r==="00"?`${n} ${a}`:`${r} ${n} ${a}`)}function y({type:t,end:s,start:a,country:n,cause:r}){return e.jsxs("div",{className:"text-left",children:[t==="person"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:`Born: ${a}, ${n}`}),s&&s!=="0 CE"&&e.jsx("p",{children:`Died: ${s}${r?`, ${d(r)}`:""}`})]}),t==="landmark"&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:`Built: ${a}, ${n}`}),s&&s!=="0 CE"&&e.jsx("p",{children:`Destroyed: ${s}${r?`, ${d(r)}`:""}`})]}),(t==="event"||t==="period")&&e.jsxs(e.Fragment,{children:[e.jsx("p",{children:`Start: ${a}, ${n}`}),s&&s!=="0 CE"&&e.jsx("p",{children:`End: ${s}${r?`, ${d(r)}`:""}`})]})]})}function k({start:t,end:s,country:a,cause:n,type:r,name:i,description:l,subject:o}){return e.jsxs(e.Fragment,{children:[e.jsxs("h2",{className:"card-title text-slate-300 text-xl",children:[d(i),e.jsx("div",{className:"badge badge-secondary",children:r.charAt(0).toUpperCase()+r.slice(1)})]}),e.jsx(y,{start:t,end:s,country:a,cause:n,type:r}),e.jsx("p",{className:"justify-start text-left flex mb-2 text-base md:text-lg text-slate-300",children:d(l)}),e.jsx("div",{className:"card-actions justify-start mb-1",children:o.map(c=>e.jsx("div",{className:"badge badge-outline",children:c.subject.charAt(0).toUpperCase()+c.subject.slice(1)},c.subject))})]})}function D({liked:t,id:s}){const{isAuth:a}=u(),{setLikeId:n}=j(),r=w();function i(){a.token?n(s):r("/login")}return e.jsx("button",{onClick:()=>i(),className:"btn btn-ghost absolute top-2 btn-sm right-1","aria-label":"Like article",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:t?"currentColor":"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"})})})}function L({id:t,username:s,liked:a,userId:n,created:r}){const{isAuth:i}=u(),{setDeleteId:l,deleteId:o}=j();function c(){l(t),document.getElementById(`my_modal_${o}`).showModal()}return e.jsxs(e.Fragment,{children:[n==i.id?e.jsxs("div",{className:"flex justify-center mt-2",children:[e.jsx(m,{className:"btn btn-secondary btn-sm w-16 mr-3",to:`/edit/${t}`,children:"Edit"}),e.jsx("button",{className:"btn btn-outline btn-sm w-16",onClick:()=>c(),children:"Delete"})]}):s&&e.jsxs("p",{className:"text-right italic text-gray-500 text-sm",children:["by"," ",e.jsx(m,{className:"text-gray-400 not-italic",to:`/user/${n}`,children:s}),", ",new Date(r).toLocaleDateString("en-GB")]}),n!=i.id?e.jsx(D,{liked:a,id:t}):e.jsx(m,{to:"/login"})]})}function E({name:t,id:s,type:a,start:n,end:r,country:i,cause:l,description:o,subject:c,username:x,liked:p,userId:f,created:b}){const g=window.innerWidth<=768;return e.jsx("div",{className:"card bg-base-100 shadow-xl",style:{width:"clamp(350px, 40vw, 550px)",...g&&{width:"max(350px, 70vw)"}},children:e.jsxs("div",{className:"card-body",children:[e.jsx(k,{name:t,type:a,start:n,end:r,country:i,cause:l,description:o,subject:c}),e.jsx(L,{id:s,username:x,liked:p,userId:f,created:b})]})})}function M({details:t,even:s,innerRef:a}){const{updateYear:n}=v(),{ref:r,inView:i,entry:l}=$({rootMargin:"0px 0px -70% 0px"});return N.useEffect(()=>{if(i){const o=l.target,c=o.textContent,x=C(c);n(x),o.classList.add("text-slate-50")}else l&&l.target.classList.remove("text-slate-50")},[i,l,n]),e.jsxs("li",{ref:a,children:[e.jsx("div",{className:"timeline-middle w-full",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",className:"h-6 w-6",children:e.jsx("circle",{cx:"10",cy:"10",r:"5",fill:"currentColor",clipRule:"evenodd"})})}),e.jsxs("div",{className:s?"timeline-start md:text-start text-left mb-5":"timeline-end mb-5",children:[e.jsx("div",{className:s?"timeline-start md:text-end mb-5":"timeline-end text-left mb-5",children:e.jsx("time",{ref:r,className:"font-mono italic text-slate-300 text-lg",children:h(t.start)})}),e.jsx(E,{liked:t.liked,id:t.id,start:h(t.start),end:h(t.end),name:t.name,type:t.type,country:t.countryId,cause:t.cause,description:t.description,subject:t.subjects,username:t.user.username,userId:t.userId,created:t.createdAt},t.id)]}),e.jsx("hr",{})]})}export{M as default};
