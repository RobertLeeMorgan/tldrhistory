import{j as e,r as h,u as m,g as b,f as j,a as g,b as w,c as v,d as y,L as k}from"./index-CE8pa9x5.js";function p({title:t,value:r,desc:s,format:o}){return e.jsxs("div",{className:"stat place-items-center text-sm py-4 px-0 md:px-4 md:px-6",children:[t&&e.jsx("div",{className:"stat-title text-slate-300",children:t}),e.jsx("div",{className:o||"stat-value text-slate-200 text-xl md:text-4xl",children:r}),s&&e.jsx("div",{className:"stat-desc text-slate-300",children:s})]})}function C({year:t}){const[r,s]=h.useState({population:1e4,year_start:-3e5,year_end:-200001}),{data:o}=m({queryKey:["population"],queryFn:g,throwOnError:!0}),{data:n}=m({queryKey:["popular",t],queryFn:()=>w(t),throwOnError:!0});h.useEffect(()=>{if(o&&o.population)for(let d=0;d<o.population.length;d++){const c=o.population[d];if(t>=c.year_start&&t<=c.year_end){s(c);return}}},[o,t]);const l=n&&n.length>0?n[0]["post.name"]:"",a=n&&n.length>0?n[0]["post.type"]:"",i=n&&n.length>0?n[0].likes:"";return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"stats bg-purple-800 stats-vertical border bottom-0 left:0 md:right-0 border-black h-full overflow-hidden rounded-none shadow fixed z-50 w-min ",children:[e.jsx(p,{value:b(t),desc:t>0?"Century CE":"Century BCE"}),e.jsx(p,{title:"Global Population",value:j(r.population)}),e.jsx(p,{title:"Most Popular",value:l?l.toUpperCase():"-",desc:`${a.charAt(0).toUpperCase()+a.slice(1)}, ${i} like(s)`,format:`${l.length<8?"text-xl leading-6":"text-sm leading-2"} md:text-xl md:leading-5 text-slate-300 font-semibold text-ellipsis overflow-hidden text-wrap w-40 text-center`})]})})}function N({centuries:t}){return e.jsx("thead",{children:e.jsxs("tr",{children:[e.jsx("th",{className:"w-12"}),t.map(r=>e.jsx("th",{className:"w-12 text-sm font-normal"},r))]})})}function _({centuries:t,continent:r,rowIndex:s,row:o}){return e.jsxs("tr",{children:[s===0&&e.jsx("td",{className:"hidden md:table-cell left-0 h-full fixed bg-slate-950",children:e.jsx("div",{className:"md:w-40 md:text-nowrap text-center text-slate-300",children:r})}),t.map((n,l)=>{const a=o.filter(d=>Math.floor(d.start_year/100)<=n&&Math.floor(d.end_year/100)>=n);let i;return a.length>0?i=a.filter((c,x,u)=>x===u.findIndex(f=>f.name===c.name)).map((c,x)=>{const u=Math.ceil((c.end_year-c.start_year)/100);return x===0&&l===Math.floor(c.start_year/100)+3e3?e.jsx("td",{className:"text-center text-sm bg-fuchsia-700 border border-slate-900 border-2 rounded-md shadow truncate ",colSpan:u,children:c.name.toUpperCase()},`${r}-${n}-${s}-${x}`):null}):i=e.jsx("td",{},`${r}-${n}-${s}`),i})]},`${r}-${s}`)}function $({centuries:t,continents:r,civil:s}){return e.jsx("tbody",{children:r.map(o=>{const n=s.civil.filter(a=>a.country.continent===o);n.sort((a,i)=>a.start_year-i.start_year);let l=[];return n.forEach(a=>{let i=!1;for(let d=0;d<l.length;d++)if(!l[d].some(u=>a.start_year<=u.end_year&&a.end_year>=u.start_year||u.start_year<=a.end_year&&u.end_year>=a.start_year)){l[d].push(a),i=!0;break}i||l.push([a])}),l.map((a,i)=>e.jsx(_,{continent:o,rowIndex:i,centuries:t,row:a},`${o}-${i}`))})})}function M({civil:t}){const r=h.useMemo(()=>{const o=[];for(let n=-3e3;n<=30;n++)n!==0&&o.push(n);return o},[]),s=h.useMemo(()=>[...new Set(t.civil.map(o=>o.country.continent))],[t]);return e.jsxs("table",{className:"table-fixed w-12 bg-gray-900 pb-4",children:[e.jsx(N,{centuries:r}),e.jsx($,{centuries:r,continents:s,civil:t})]})}function L({civil:t,year:r}){const s=h.useRef(null);return h.useEffect(()=>{const o=Math.floor(r/100)+3e3;if(s.current){const l=s.current.clientWidth-150,a=o*48-l/2;s.current.scrollLeft=a}},[r]),e.jsx("div",{className:"overflow-hidden scroll-smooth",ref:s,children:e.jsx(M,{civil:t})})}function E({widgetDisplay:t}){const{year:r}=v(),{data:s}=m({queryKey:["civil"],queryFn:y,throwOnError:!0});return e.jsx("div",{className:`${t?"translate-y-0":"translate-y-full"} fixed w-screen bottom-0 z-30 transform duration-300 ease-in-out`,children:s&&e.jsxs(e.Fragment,{children:[e.jsx(C,{year:r}),e.jsx(L,{civil:s,year:r})]})})}function W({widgetDisplay:t,handleClick:r,handleSort:s}){return e.jsxs("div",{className:"menu fixed z-40 top-28 right-0 lg:right-2 xl:top-20 xl:right-4 2xl:right-6 2xl:top-28 w-max",children:[e.jsx("div",{className:"tooltip tooltip-left","data-tip":"Create article",children:e.jsx(k,{className:"btn btn-circle btn-secondary drawer-button mb-3 border border-black btn-md xl:btn-lg border-2 hover:border-gray-300 hover:border",to:"/post",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-12 h-12",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})})})}),e.jsx("div",{className:"tooltip tooltip-left","data-tip":"Search/filter",children:e.jsx("label",{htmlFor:"my-drawer",className:"btn drawer-button z-50 btn-circle btn-md xl:btn-lg mb-3 border border-black hover:border-gray-400 hover:border",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})}),e.jsx("div",{className:"tooltip tooltip-left","data-tip":"Sort",children:e.jsx("button",{onClick:s,className:"btn btn-circle drawer-button btn-md mb-3 xl:btn-lg border border-black hover:border-gray-400 hover:border-1",children:e.jsxs("svg",{fill:"currentColor",height:"30px",width:"30px",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 490.00 490.00",children:[e.jsx("g",{id:"SVGRepo_tracerCarrier",strokeLinecap:"round",strokeLinejoin:"round"})," ",e.jsx("polygon",{points:"85.877,154.014 85.877,428.309 131.706,428.309 131.706,154.014 180.497,221.213 217.584,194.27 108.792,44.46 0,194.27 37.087,221.213 "})," ",e.jsx("polygon",{points:"404.13,335.988 404.13,61.691 358.301,61.691 358.301,335.99 309.503,268.787 272.416,295.73 381.216,445.54 490,295.715 452.913,268.802 "})," "]})})}),e.jsx("div",{className:"tooltip tooltip-left font-normal","data-tip":"Display widgets",children:e.jsx("button",{className:`btn btn-circle border border-black z-50 xl:btn-lg hover:border-gray-300 hover:border transform transition-transform ease-in-out ${t?"":"rotate-180"}`,onClick:()=>{r()},children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})})]})}function S({handleSort:t}){const[r,s]=h.useState(!1);function o(){s(!r)}return e.jsxs(e.Fragment,{children:[e.jsx(W,{widgetDisplay:r,handleClick:o,handleSort:t}),e.jsx(E,{widgetDisplay:r})]})}export{S as default};
